---
title: 'Metadata Filtering'
description: 'Filter reference for search and retrieval'
---

Filter search results by metadata attributes using comparison and logical operators.

## Operators Reference

| Operator | Description | Example |
|----------|-------------|---------|
| `$eq` | Equals (default) | `{"status": "active"}` |
| `$ne` | Not equals | `{"status": {"$ne": "archived"}}` |
| `$gt` | Greater than | `{"score": {"$gt": 80}}` |
| `$gte` | Greater than or equal | `{"priority": {"$gte": 7}}` |
| `$lt` | Less than | `{"age": {"$lt": 30}}` |
| `$lte` | Less than or equal | `{"count": {"$lte": 100}}` |
| `$in` | Value in list | `{"status": {"$in": ["a", "b"]}}` |
| `$nin` | Not in list | `{"status": {"$nin": ["x", "y"]}}` |
| `$like` | Pattern match (case-sensitive) | `{"title": {"$like": "Important%"}}` |
| `$ilike` | Pattern match (case-insensitive) | `{"email": {"$ilike": "%@company.com"}}` |
| `$overlap` | Array has any | `{"tags": {"$overlap": ["urgent", "important"]}}` |
| `$contains` | Array has all | `{"skills": {"$contains": ["python", "ml"]}}` |
| `$and` | All conditions match | `{"$and": [{...}, {...}]}` |
| `$or` | Any condition matches | `{"$or": [{...}, {...}]}` |

<Tip>Use `%` as wildcard in `$like` and `$ilike` patterns.</Tip>
<Tip>Target metadata fields with the `metadata.` prefix (e.g., `metadata.status`). Nested fields are supported.</Tip>

<Info>Search responses can optionally include metadata via `search_settings.include_metadata`. When included, Nebula returns a whitelisted subset (e.g., `title`, `source`, `url`, `doc_type`, `mime_type`, `filename`, `page`) to keep results compact.</Info>

## Examples

<CodeGroup>

```python Python
from nebula import Nebula
nebula = Nebula(api_key="your-api-key")

# Simple equality
results = nebula.search(
    query="machine learning",
    collection_ids=["docs"],
    filters={"metadata.category": "research"}
)

# Multiple conditions with $and
results = nebula.search(
    query="reports",
    collection_ids=["tasks"],
    filters={
        "$and": [
            {"metadata.priority": {"$gte": 7}},
            {"metadata.status": {"$in": ["pending", "active"]}},
            {"metadata.created_at": {"$gte": "2024-01-01"}}
        ]
    }
)

# Array operations
results = nebula.search(
    query="candidates",
    collection_ids=["hr"],
    filters={"metadata.skills": {"$contains": ["python", "ml"]}}
)
```

```javascript JavaScript
const { Nebula } = require('@nebula-ai/sdk');
const nebula = new Nebula({ apiKey: 'your-api-key' });

// Simple equality
const results = await nebula.search({
  query: "machine learning",
  collection_ids: ["docs"],
  filters: {"metadata.category": "research"}
});

// Multiple conditions with $and
const results2 = await nebula.search({
  query: "reports",
  collection_ids: ["tasks"],
  filters: {
    "$and": [
      {"metadata.priority": {"$gte": 7}},
      {"metadata.status": {"$in": ["pending", "active"]}},
      {"metadata.created_at": {"$gte": "2024-01-01"}}
    ]
  }
});

// Array operations
const results3 = await nebula.search({
  query: "candidates",
  collection_ids: ["hr"],
  filters: {"metadata.skills": {"$contains": ["python", "ml"]}}
});
```

```bash cURL
# Simple equality
curl -X POST "https://api.trynebula.ai/v1/memories/search" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "query": "machine learning",
    "collection_ids": ["docs"],
    "filters": {"metadata.category": "research"}
  }'

# Multiple conditions with $and
curl -X POST "https://api.trynebula.ai/v1/memories/search" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "query": "reports",
    "collection_ids": ["tasks"],
    "filters": {
      "$and": [
        {"metadata.priority": {"$gte": 7}},
        {"metadata.status": {"$in": ["pending", "active"]}},
        {"metadata.created_at": {"$gte": "2024-01-01"}}
      ]
    }
  }'
```

</CodeGroup>

## Common Patterns

### Date Ranges
```python
from datetime import datetime, timedelta

# Last 30 days
start = (datetime.now() - timedelta(days=30)).isoformat()
filters = {"metadata.created_at": {"$gte": start}}

# Date range
filters = {
    "$and": [
        {"metadata.created_at": {"$gte": "2024-01-01"}},
        {"metadata.created_at": {"$lte": "2024-12-31"}}
    ]
}
```

### Multi-Status
```python
# Include specific statuses
filters = {"metadata.status": {"$in": ["pending", "in_progress", "review"]}}

# Exclude specific statuses
filters = {"metadata.status": {"$nin": ["archived", "deleted"]}}
```

### Nested Properties
```python
# Filter nested object properties
filters = {
    "metadata.user.profile.age": {"$gte": 25},
    "metadata.user.location.city": "San Francisco"
}
```

<Tip>Store numbers as numbers and booleans as booleans for correct comparisons. Use `$overlap` for "any of" matching and `$contains` for "all of" matching.</Tip>

## Next Steps

- [Search Guide](/guides/search) - Semantic search strategies
- [Memory Operations](/guides/memory-operations) - Core CRUD operations
